<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Debug - Calculs de Rendez-vous Relativiste</title>
    <style>
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        
        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .controls {
            background: white;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .input-group {
            display: flex;
            gap: 20px;
            margin-bottom: 15px;
            align-items: center;
        }
        
        .input-group label {
            min-width: 120px;
            font-weight: bold;
        }
        
        .input-group input {
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 5px;
            width: 100px;
        }
        
        .button {
            background: #667eea;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        
        .button:hover {
            background: #5a6fd8;
        }
        
        .results {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
            margin-bottom: 20px;
        }
        
        .result-card {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .result-card h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .param-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            padding: 5px 0;
        }
        
        .param-label {
            font-weight: bold;
            color: #555;
        }
        
        .param-value {
            font-family: 'Courier New', monospace;
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            color: #333;
        }
        
        .error {
            background: #ffebee;
            color: #c62828;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #c62828;
        }
        
        .success {
            background: #e8f5e8;
            color: #2e7d32;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #2e7d32;
        }
        
        .physics-note {
            background: #fff3e0;
            color: #ef6c00;
            padding: 15px;
            border-radius: 5px;
            margin: 10px 0;
            border-left: 4px solid #ef6c00;
        }
        
        .comparison {
            background: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        
        .comparison h3 {
            margin-top: 0;
            color: #333;
            border-bottom: 2px solid #667eea;
            padding-bottom: 10px;
        }
        
        .comparison-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 15px;
        }
        
        .comparison-table th,
        .comparison-table td {
            padding: 10px;
            text-align: center;
            border: 1px solid #ddd;
        }
        
        .comparison-table th {
            background: #f8f9fa;
            font-weight: bold;
        }
        
        .comparison-table tr:nth-child(even) {
            background: #f8f9fa;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>üî¨ Debug - Calculs de Rendez-vous Relativiste</h1>
        <p>Validation des calculs bas√©s sur la rapidit√© (œÜ) - Phase 1 TDD</p>
    </div>

    <div class="controls">
        <h3>üìä Param√®tres d'entr√©e</h3>
        <div class="input-group">
            <label>Vitesse initiale v‚ÇÄ:</label>
            <input type="number" id="v0" value="0.3" step="0.1" min="0" max="0.99" title="Vitesse initiale en unit√©s de c">
            <span>(en unit√©s de c)</span>
        </div>
        <div class="input-group">
            <label>Distance Œîx:</label>
            <input type="number" id="deltaX" value="10" step="1" min="0" title="Distance en ann√©es-lumi√®re">
            <span>(ann√©es-lumi√®re)</span>
        </div>
        <div class="input-group">
            <label>Temps Œît:</label>
            <input type="number" id="deltaT" value="12" step="1" min="0" title="Temps en ann√©es">
            <span>(ans)</span>
        </div>
        <button class="button" onclick="calculateRendezvous()">üöÄ Calculer le Rendez-vous</button>
    </div>

    <div id="error-container"></div>
    <div id="results-container"></div>

    <div class="comparison">
        <h3>üìã Comparaison avec les Exemples du Document</h3>
        <table class="comparison-table">
            <thead>
                <tr>
                    <th>Param√®tre</th>
                    <th>Cas A (v‚ÇÄ = 0)</th>
                    <th>Cas B (v‚ÇÄ = 0.3c)</th>
                    <th>Votre Calcul</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td><strong>Œ≤ = Œîx/(cŒît)</strong></td>
                    <td>0.8333</td>
                    <td>0.8333</td>
                    <td id="beta-comp">-</td>
                </tr>
                <tr>
                    <td><strong>œÜ‚ÇÄ = artanh(v‚ÇÄ)</strong></td>
                    <td>0</td>
                    <td>0.3095</td>
                    <td id="phi0-comp">-</td>
                </tr>
                <tr>
                    <td><strong>ŒîœÜ</strong></td>
                    <td>2.4010</td>
                    <td>1.7820</td>
                    <td id="deltaPhi-comp">-</td>
                </tr>
                <tr>
                    <td><strong>Œ± (c/an)</strong></td>
                    <td>0.4594</td>
                    <td>0.3323</td>
                    <td id="alpha-comp">-</td>
                </tr>
                <tr>
                    <td><strong>œÑ_f (ans)</strong></td>
                    <td>5.23</td>
                    <td>5.36</td>
                    <td id="tauF-comp">-</td>
                </tr>
                <tr>
                    <td><strong>v_f (c)</strong></td>
                    <td>0.983</td>
                    <td>0.970</td>
                    <td id="vF-comp">-</td>
                </tr>
            </tbody>
        </table>
    </div>

    <script type="module">
        import {
            SPEED_OF_LIGHT,
            artanh,
            velocityToRapidity,
            rapidityToVelocity,
            calculateRendezvousRapidity,
            calculateRequiredAcceleration,
            calculateFinalProperTime,
            solveRendezvousProblem,
            validateRendezvous
        } from './js/physics_relativistic/index.js';

        window.calculateRendezvous = function() {
            const v0 = parseFloat(document.getElementById('v0').value);
            const deltaX = parseFloat(document.getElementById('deltaX').value);
            const deltaT = parseFloat(document.getElementById('deltaT').value);
            
            const errorContainer = document.getElementById('error-container');
            const resultsContainer = document.getElementById('results-container');
            
            // Clear previous results
            errorContainer.innerHTML = '';
            resultsContainer.innerHTML = '';
            
            try {
                // Validation
                if (!validateRendezvous(deltaX, deltaT)) {
                    throw new Error('Rendez-vous impossible : violation de la causalit√©');
                }
                
                // Calculs interm√©diaires
                const beta = deltaX / (SPEED_OF_LIGHT * deltaT);
                const phi0 = velocityToRapidity(v0);
                const artanhBeta = artanh(beta);
                
                // R√©solution compl√®te
                const result = solveRendezvousProblem(0, 0, v0, deltaX, deltaT);
                
                // Affichage des r√©sultats
                displayResults(v0, deltaX, deltaT, beta, phi0, artanhBeta, result);
                
                // Mise √† jour de la comparaison
                updateComparison(beta, phi0, result);
                
            } catch (error) {
                errorContainer.innerHTML = `
                    <div class="error">
                        <strong>‚ùå Erreur de calcul :</strong> ${error.message}
                    </div>
                `;
            }
        };
        
        function displayResults(v0, deltaX, deltaT, beta, phi0, artanhBeta, result) {
            const resultsContainer = document.getElementById('results-container');
            
            resultsContainer.innerHTML = `
                <div class="results">
                    <div class="result-card">
                        <h3>üìê Param√®tres Interm√©diaires</h3>
                        <div class="param-row">
                            <span class="param-label">Œ≤ = Œîx/(cŒît):</span>
                            <span class="param-value">${beta.toFixed(4)}</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">artanh(Œ≤):</span>
                            <span class="param-value">${artanhBeta.toFixed(4)}</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">œÜ‚ÇÄ = artanh(v‚ÇÄ):</span>
                            <span class="param-value">${phi0.toFixed(4)}</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">ŒîœÜ = 2[artanh(Œ≤) - œÜ‚ÇÄ]:</span>
                            <span class="param-value">${result.deltaPhi.toFixed(4)}</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">œÜ_f = œÜ‚ÇÄ + ŒîœÜ:</span>
                            <span class="param-value">${result.phi_f.toFixed(4)}</span>
                        </div>
                    </div>
                    
                    <div class="result-card">
                        <h3>üöÄ R√©sultats du Rendez-vous</h3>
                        <div class="param-row">
                            <span class="param-label">Acc√©l√©ration Œ±:</span>
                            <span class="param-value">${result.alpha.toFixed(4)} c/an</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">Temps propre œÑ_f:</span>
                            <span class="param-value">${result.tau_f.toFixed(2)} ans</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">Vitesse finale v_f:</span>
                            <span class="param-value">${result.v_f.toFixed(3)} c</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">√ânergie consomm√©e:</span>
                            <span class="param-value">${result.energyConsumed.toFixed(4)} m‚ÇÄc¬≤ (${(result.energyConsumed * 25).toFixed(1)} GWh/tonne)</span>
                        </div>
                        <div class="param-row">
                            <span class="param-label">Ratio œÑ_f/Œît:</span>
                            <span class="param-value">${(result.tau_f / deltaT).toFixed(3)}</span>
                        </div>
                    </div>
                </div>
                
                <div class="physics-note">
                    <strong>üî¨ Validation Physique :</strong>
                    <ul>
                        <li>‚úÖ Œ≤ < 1 : Rendez-vous causalement possible</li>
                        <li>‚úÖ œÑ_f ‚â§ Œît : Temps propre ‚â§ temps coordonn√©</li>
                        <li>‚úÖ v_f < c : Vitesse finale sous-luminique</li>
                        <li>‚úÖ √ânergie ‚â• 0 : √ânergie consomm√©e positive</li>
                    </ul>
                </div>
                
                <div class="success">
                    <strong>‚úÖ Rendez-vous R√©alisable !</strong>
                    Le vaisseau peut atteindre le point de rendez-vous en ${result.tau_f.toFixed(2)} ans de temps propre 
                    (${deltaT} ans de temps coordonn√©) avec une acc√©l√©ration propre de ${result.alpha.toFixed(4)} c/an
                    ${result.alpha > 0 ? '(acc√©l√©ration)' : result.alpha < 0 ? '(d√©c√©l√©ration)' : '(immobile)'}.
                </div>
            `;
        }
        
        function updateComparison(beta, phi0, result) {
            document.getElementById('beta-comp').textContent = beta.toFixed(4);
            document.getElementById('phi0-comp').textContent = phi0.toFixed(4);
            document.getElementById('deltaPhi-comp').textContent = result.deltaPhi.toFixed(4);
            document.getElementById('alpha-comp').textContent = result.alpha.toFixed(4);
            document.getElementById('tauF-comp').textContent = result.tau_f.toFixed(2);
            document.getElementById('vF-comp').textContent = result.v_f.toFixed(3);
        }
        
        // Calcul initial au chargement
        window.addEventListener('load', function() {
            calculateRendezvous();
        });
    </script>
</body>
</html> 